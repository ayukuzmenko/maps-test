(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{103:function(e,n,t){"use strict";t.r(n);var r=t(0),a=t.n(r),o=t(45),i=t.n(o),s=t(7),c=t(4),d=t(5),u=t(8),l=t(6),p=t(9),f=(t(62),function(e){function n(){var e,t;Object(c.a)(this,n);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return(t=Object(u.a)(this,(e=Object(l.a)(n)).call.apply(e,[this].concat(a)))).initMap=function(){t._map=new window.ymaps.Map("map",{center:[55.76,37.64],zoom:10},{searchControlProvider:"yandex#search"})},t.handlerDragEnd=function(e){var n=e.get("target"),r=t.props.replacePoint,a=n.geometry.getCoordinates();r({arrIndex:n.properties.get("arrIndex"),newCoords:a})},t}return Object(p.a)(n,e),Object(d.a)(n,[{key:"render",value:function(){return a.a.createElement("div",{id:"map",className:"containerMap"})}},{key:"componentDidMount",value:function(){window.ymaps.ready(this.initMap)}},{key:"componentDidUpdate",value:function(){this._map.geoObjects.removeAll(),this.addPoint(),this.addPolyLine()}},{key:"addPoint",value:function(){var e=this;this.props.points.forEach(function(n,t){var r=new window.ymaps.Placemark(n.coords,{iconCaption:n.adress,arrIndex:t},{draggable:!0,preset:"islands#darkBlueDotIconWithCaptio",iconCaptionMaxWidth:"150"});e._map.geoObjects.add(r),r.events.add("dragend",e.handlerDragEnd)})}},{key:"addPolyLine",value:function(){var e=this.props.points;if(!(e.length<=1)){var n=e.map(function(e){return e.coords}),t=new window.ymaps.Polyline(n,{balloonContent:"\u041c\u0430\u0440\u0448\u0440\u0443\u0442"},{balloonCloseButton:!1,strokeColor:"#000000",strokeWidth:3,strokeOpacity:.5});this._map.geoObjects.add(t)}}}]),n}(r.Component)),m=Object(s.b)(function(e){return{points:e.points}},function(e){return{replacePoint:e.points.getNewCoords}})(f),h=(t(64),function(e){function n(){var e,t;Object(c.a)(this,n);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return(t=Object(u.a)(this,(e=Object(l.a)(n)).call.apply(e,[this].concat(a)))).state={map:null},t.initSearch=function(){new window.ymaps.SuggestView("suggest").events.add("select",t.chekPointHandler)},t.chekPointHandler=function(e){e.preventDefault(),t.props.addPoint(e.get("item").value),t._inputAddress.value=""},t}return Object(p.a)(n,e),Object(d.a)(n,[{key:"render",value:function(){var e=this;return a.a.createElement("div",null,a.a.createElement("p",{className:"header"},"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0430\u0434\u0440\u0435\u0441 \u0442\u043e\u0447\u043a\u0438:"),a.a.createElement("input",{name:"address",type:"text",id:"suggest",className:"suggest",ref:function(n){return e._inputAddress=n}}))}},{key:"componentDidMount",value:function(){window.ymaps.ready(this.initSearch)}}]),n}(r.Component)),b=Object(s.b)(null,function(e){return{addPoint:e.points.searchPoint}})(h),g=t(52),v=t(27),w=function(e){function n(){var e,t;Object(c.a)(this,n);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return(t=Object(u.a)(this,(e=Object(l.a)(n)).call.apply(e,[this].concat(a)))).deletePointHandler=function(){t.props.deletePoint(t.props.item.id)},t}return Object(p.a)(n,e),Object(d.a)(n,[{key:"render",value:function(){var e=this.props.item;return a.a.createElement("div",null,a.a.createElement("span",{className:"test"},e.adress),a.a.createElement("button",{onClick:this.deletePointHandler},"x"))}}]),n}(r.Component),y=Object(s.b)(null,function(e){return{deletePoint:e.points.deletePoint}})(w),O=function(e){function n(){var e,t;Object(c.a)(this,n);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return(t=Object(u.a)(this,(e=Object(l.a)(n)).call.apply(e,[this].concat(a)))).dragEndHandler=function(e){if(e.destination){var n=t.props,r=n.points;(0,n.reoderPoints)(j(r,e.source.index,e.destination.index))}},t}return Object(p.a)(n,e),Object(d.a)(n,[{key:"render",value:function(){var e=this;return this.props.points.length?a.a.createElement(v.a,{onDragEnd:this.dragEndHandler},a.a.createElement(v.c,{droppableId:"droppable"},function(n,t){return a.a.createElement("div",Object.assign({ref:n.innerRef},n.droppableProps),e.pointBody,n.placeholder)})):null}},{key:"pointBody",get:function(){return this.props.points.map(function(e,n){return a.a.createElement(v.b,{key:e.id,draggableId:e.id,index:n},function(n,t){return a.a.createElement("div",Object.assign({ref:n.innerRef},n.draggableProps,n.dragHandleProps),a.a.createElement(y,{item:e}))})})}}]),n}(r.Component),j=function(e,n,t){var r=Array.from(e),a=r.splice(n,1),o=Object(g.a)(a,1)[0];return r.splice(t,0,o),r},P=Object(s.b)(function(e){return{points:e.points}},function(e){return{reoderPoints:e.points.reoderPoints}})(O),E=function(e){function n(){return Object(c.a)(this,n),Object(u.a)(this,Object(l.a)(n).apply(this,arguments))}return Object(p.a)(n,e),Object(d.a)(n,[{key:"render",value:function(){return a.a.createElement("div",null,a.a.createElement(m,null),a.a.createElement("div",{className:"container"},a.a.createElement(b,null),a.a.createElement(P,null)))}}]),n}(r.Component),k=t(50),C=t(51),x=t.n(C),I=t(17),A=t.n(I),D=t(32),N={state:[],reducers:{reoderPoints:function(e,n){return n},addNewPoint:function(e,n){return e.push({id:n.newPointId,coords:n.coords,adress:n.adress}),e},deletePoint:function(e,n){return e.filter(function(e){return e.id!==n})},replacePoint:function(e,n){e[n.arrIndex]={id:e[n.arrIndex].id,coords:n.coords,adress:n.adress}}},effects:function(e){return{searchPoint:function(){var e=Object(D.a)(A.a.mark(function e(n){var t=this;return A.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:window.ymaps.geocode(n,{result:1}).then(function(e){var n=e.geoObjects.get(0);n&&t.addNewPoint({adress:n.getAddressLine(),coords:n.geometry.getCoordinates(),newPointId:(Date.now()+Math.random()).toString()})});case 1:case"end":return e.stop()}},e,this)}));return function(n){return e.apply(this,arguments)}}(),getNewCoords:function(){var n=Object(D.a)(A.a.mark(function n(t){return A.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:window.ymaps.geocode(t.newCoords,{result:1}).then(function(n){var r=n.geoObjects.get(0);if(n){var a=r.getAddressLine()?r.getAddressLine():"Address unknown";e.points.replacePoint({adress:a,coords:t.newCoords,arrIndex:t.arrIndex})}});case 1:case"end":return n.stop()}},n,this)}));return function(e){return n.apply(this,arguments)}}()}}},M=x()(),H=Object(k.init)({models:{points:N},plugins:[M]});i.a.render(a.a.createElement(s.a,{store:H},a.a.createElement(E,null)),document.getElementById("root"))},53:function(e,n,t){e.exports=t(103)},62:function(e,n,t){},64:function(e,n,t){}},[[53,2,1]]]);
//# sourceMappingURL=main.14cb52c4.chunk.js.map